<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸ’ å¯†é’¥æå– & è½¬æ¢ Â· Key Extract & Convert â€” åŒè¯­ç‰ˆ</title>
<style>
  body { background:#0b0b0b; color:#ffd966; font-family:"Segoe UI",Tahoma,Geneva,Verdana,sans-serif; padding:20px; transition:0.3s; }
  h1 { text-align:center; margin-bottom:8px; font-size:22px; }
  .container{max-width:980px;margin:0 auto;}
  .controls{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px;align-items:center;}
  textarea{width:100%;height:160px;background:#111;border:1px solid #333;color:#ffd966;padding:12px;font-family:monospace;font-size:14px;resize:vertical;}
  .btn{background:#111;border:1px solid #b88a00;color:#ffd966;padding:8px 14px;border-radius:6px;cursor:pointer;}
  .btn:hover{background:#b88a00;color:#0b0b0b;box-shadow:0 6px 18px rgba(184,138,0,0.18);}
  .copy-btn{position:absolute;right:8px;top:8px;padding:6px 10px;font-size:12px}
  .result-wrap{position:relative;margin-bottom:18px;}
  label{margin-right:4px;}
  .prefix-input{width:120px;padding:6px;background:#111;border:1px solid:#333;color:#ffd966;border-radius:6px;}
  footer{margin-top:18px;font-size:13px;color:#bfbfbf;text-align:center;}
  .note{font-size:13px;color:#e6c86b}
  .lang-btn{position:fixed;top:18px;right:18px;padding:8px 14px;font-size:13px;border-radius:6px;background:#111;border:1px solid #b88a00;cursor:pointer;color:#ffd966;}
  .lang-btn:hover{background:#b88a00;color:#0b0b0b;}
</style>
</head>
<body>

<button id="langBtn" class="lang-btn">English</button>

<div class="container">
  <h1 id="title">ğŸ’ å¯†é’¥æå– & è½¬æ¢ (åŒè¯­ç‰ˆ)</h1>

  <div class="controls">
    <label for="prefix" id="labelPrefix">å‰ç¼€ï¼š</label>
    <input id="prefix" class="prefix-input" value="ID" />

    <label for="startNum" id="labelStart">èµ·å§‹ç¼–å·ï¼š</label>
    <input id="startNum" class="prefix-input" placeholder="å¦‚ 50 / 090 / 005" />

    <button class="btn" id="btnExtract" onclick="extract()">æå–</button>
    <button class="btn" id="btnConvert" onclick="convert()">è½¬æ¢</button>
    <button class="btn" id="btnClear" onclick="clearAll()">æ¸…ç©º</button>
    <button class="btn" id="btnDownload" onclick="downloadResult()">ä¸‹è½½</button>
  </div>

  <textarea id="inputText" placeholder="åœ¨æ­¤ç²˜è´´åŸå§‹æ•°æ®..."></textarea>

  <h2 id="exTitle">æå–ç»“æœ</h2>
  <div class="result-wrap">
    <button class="btn copy-btn" id="btnCopyExtract" onclick="copyResult('extracted')">ğŸ“‹ å¤åˆ¶</button>
    <textarea id="extracted" readonly></textarea>
  </div>

  <h2 id="cvTitle">è½¬æ¢ç»“æœ</h2>
  <div class="result-wrap">
    <button class="btn copy-btn" id="btnCopyConvert" onclick="copyResult('converted')">ğŸ“‹ å¤åˆ¶</button>
    <textarea id="converted" readonly></textarea>
  </div>

  <p class="note" id="note">æ”¯æŒæ‰€æœ‰æ ¼å¼ï¼Œä¿æŒé¡ºåºï¼Œè‡ªå®šä¹‰ç¼–å·ï¼Œè‡ªåŠ¨è¡¥é›¶ã€‚</p>
  <footer id="footer">ğŸ’ åŒè¯­ç»ˆæç‰ˆ Â· Bilingual Ultimate Edition</footer>
</div>

<script>
// -------------------- å¤šè¯­è¨€å­—å…¸ --------------------
const lang = {
  zh: {
    title: "ğŸ’ å¯†é’¥æå– & è½¬æ¢ (åŒè¯­ç‰ˆ)",
    prefix: "å‰ç¼€ï¼š",
    start: "èµ·å§‹ç¼–å·ï¼š",
    extract: "æå–",
    convert: "è½¬æ¢",
    clear: "æ¸…ç©º",
    download: "ä¸‹è½½",
    placeholder: "åœ¨æ­¤ç²˜è´´åŸå§‹æ•°æ®...",
    exTitle: "æå–ç»“æœ",
    cvTitle: "è½¬æ¢ç»“æœ",
    copy: "ğŸ“‹ å¤åˆ¶",
    note: "æ”¯æŒæ‰€æœ‰æ ¼å¼ï¼Œä¿æŒé¡ºåºï¼Œè‡ªå®šä¹‰ç¼–å·ï¼Œè‡ªåŠ¨è¡¥é›¶ã€‚",
    copied: "å·²å¤åˆ¶ï¼",
    noData: "è¯·å…ˆæå–æ•°æ®ï¼",
    noDownload: "æ²¡æœ‰å†…å®¹å¯ä¸‹è½½ï¼",
    footer: "ğŸ’ åŒè¯­ç»ˆæç‰ˆ Â· Bilingual Ultimate Edition",
    langBtn: "English"
  },
  en: {
    title: "ğŸ’ Key Extract & Convert (Bilingual Version)",
    prefix: "Prefix:",
    start: "Start No.:",
    extract: "Extract",
    convert: "Convert",
    clear: "Clear",
    download: "Download",
    placeholder: "Paste your raw data here...",
    exTitle: "Extracted Result",
    cvTitle: "Converted Result",
    copy: "ğŸ“‹ Copy",
    note: "Supports all formats, keeps order, custom numbering, auto zero-padding.",
    copied: "Copied!",
    noData: "Please extract data first!",
    noDownload: "No content to download!",
    footer: "ğŸ’ Bilingual Ultimate Edition",
    langBtn: "ä¸­æ–‡"
  }
};

let currentLang = "zh";

// -------------------- åˆ‡æ¢è¯­è¨€ --------------------
document.getElementById("langBtn").onclick = () => {
  currentLang = currentLang === "zh" ? "en" : "zh";
  applyLang();
};

function applyLang() {
  const L = lang[currentLang];
  document.getElementById("title").innerText = L.title;
  document.getElementById("labelPrefix").innerText = L.prefix;
  document.getElementById("labelStart").innerText = L.start;
  document.getElementById("btnExtract").innerText = L.extract;
  document.getElementById("btnConvert").innerText = L.convert;
  document.getElementById("btnClear").innerText = L.clear;
  document.getElementById("btnDownload").innerText = L.download;
  document.getElementById("inputText").placeholder = L.placeholder;
  document.getElementById("exTitle").innerText = L.exTitle;
  document.getElementById("cvTitle").innerText = L.cvTitle;
  document.getElementById("btnCopyExtract").innerText = L.copy;
  document.getElementById("btnCopyConvert").innerText = L.copy;
  document.getElementById("note").innerText = L.note;
  document.getElementById("footer").innerText = L.footer;
  document.getElementById("langBtn").innerText = L.langBtn;
}

// -------------------- ä»¥ä¸‹åŸé€»è¾‘ä¿æŒä¸å˜ --------------------
function extract() {
  const raw = document.getElementById('inputText').value || '';
  const text = raw.replace(/\r/g,'').replace(/\\n/g,'\n');
  const patterns = [
    /ID\s*:\s*(\S+)[\r\n]+Pass:\s*(\S+)/g,
    /^\s*(\d+-\d+)\s+(\S+)/gm,
    /^\s*\d+\s+(\d+-\d+)\s+(\S+)/gm,
    /^\s*\d{4},(\d+-\d+),(\S+)/gm,
    /(\d+-\d+):(\S+)/gm,
    /(\d+-\d+)=(\S+)/gm,
    /è´¦å·[:ï¼š]\s*(\d+-\d+)[\s,ï¼Œ]+(?:å¯†é’¥|token|pass)[:ï¼š]?\s*(\S+)/gi,
    /"id"\s*:\s*"(\d+-\d+)"\s*,\s*"token"\s*:\s*"(\S+?)"/gi,
    /(\d+-\d+)\+(\S+)/gm,
    /(\d+-\d+)\/(\S+)/gm,
    /^[^,\n]*?,\s*(\d+-\d+)\s*,\s*([A-Za-z0-9]+)\s*$/gm
  ];

  let results = [];
  patterns.forEach(regex=>{
    let m;
    while ((m = regex.exec(text)) !== null) {
      if (m[1] && m[2]) results.push((m[1] + ' ' + m[2]).trim());
    }
  });

  const lines = text.split(/\n+/).map(l => l.trim()).filter(l => l);
  lines.forEach(line=>{
    const m = line.match(/^(\d+-\d+)\s+(\S+)/);
    if (m) results.push(m[1] + ' ' + m[2]);
  });

  results = Array.from(new Set(results.map(r => r.trim()).filter(r=>r)));

  document.getElementById('extracted').value = results.join('\n');
  document.getElementById('converted').value = '';
}

function convert() {
  const extracted = document.getElementById('extracted').value.trim();
  if (!extracted) {
    alert(lang[currentLang].noData);
    return;
  }

  const lines = extracted.split(/\n+/);
  const prefix = document.getElementById('prefix').value || 'ID';
  let startNumRaw = document.getElementById('startNum').value.trim();
  let useCustomStart = startNumRaw !== '';
  let startNum = parseInt(startNumRaw || '1', 10);

  const converted = lines.map((line, idx) => {
    const parts = line.trim().split(/\s+/);
    const id = parts[0] || '';
    const token = parts.slice(1).join(' ') || '';

    let current = useCustomStart ? startNum + idx : idx + 1;
    let padLength = useCustomStart ? startNumRaw.length : (lines.length >= 100 ? 3 : 2);
    const num = String(current).padStart(padLength, '0');

    return `${prefix}${num},${id},${token}`;
  }).join('\n');

  document.getElementById('converted').value = converted;
}

function clearAll() {
  document.getElementById('inputText').value = '';
  document.getElementById('extracted').value = '';
  document.getElementById('converted').value = '';
}

function copyResult(id) {
  const ta = document.getElementById(id);
  ta.select();
  document.execCommand('copy');
  alert(lang[currentLang].copied);
}

function downloadResult() {
  let content = document.getElementById('converted').value.trim();
  let filename = '';
  if (content) {
    filename = (document.getElementById('prefix').value || 'ID') + '.txt';
  } else {
    content = document.getElementById('extracted').value.trim();
    filename = 'token.txt';
  }
  if (!content) {
    alert(lang[currentLang].noDownload);
    return;
  }
  const blob = new Blob([content], {type:'text/plain;charset=utf-8'});
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = filename;
  link.click();
}

// åˆå§‹åŒ–ä¸ºå½“å‰è¯­è¨€
applyLang();
</script>

</body>
</html>
