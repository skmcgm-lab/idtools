<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸ’ å¯†é’¥ & æå– & è½¬æ¢ â€” ç»ˆææ•´åˆç‰ˆï¼ˆä¿æŒé¡ºåº + å…¨æ ¼å¼æ”¯æŒï¼‰</title>
<style>
  body { background:#0b0b0b; color:#ffd966; font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif; padding:20px; }
  h1 { text-align:center; margin-bottom:8px; font-size:22px; }
  .container{max-width:980px;margin:0 auto;}
  .controls{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px;align-items:center;}
  textarea{width:100%;height:160px;background:#111;border:1px solid #333;color:#ffd966;padding:12px;font-family:monospace;font-size:14px;resize:vertical;}
  .btn{background:#111;border:1px solid #b88a00;color:#ffd966;padding:8px 14px;border-radius:6px;cursor:pointer;}
  .btn:hover{background:#b88a00;color:#0b0b0b;box-shadow:0 6px 18px rgba(184,138,0,0.18);}
  .copy-btn{position:absolute;right:8px;top:8px;padding:6px 10px;font-size:12px}
  .result-wrap{position:relative;margin-bottom:18px;}
  label{margin-right:8px}
  .prefix-input{width:120px;padding:6px;background:#111;border:1px solid #333;color:#ffd966;border-radius:6px;}
  footer{margin-top:18px;font-size:13px;color:#bfbfbf;text-align:center;}
  .note{font-size:13px;color:#e6c86b}
</style>
</head>
<body>
<div class="container">
  <h1>ğŸ’ å¯†é’¥ & æå– & è½¬æ¢ â€” ç»ˆæç‰ˆ</h1>

  <div class="controls">
    <label for="prefix">è½¬æ¢å‰ç¼€ï¼š</label>
    <input id="prefix" class="prefix-input" value="ID" />
    <button class="btn" onclick="extract()">æå–</button>
    <button class="btn" onclick="convert()">è½¬æ¢</button>
    <button class="btn" onclick="clearAll()">æ¸…ç©º</button>
    <button class="btn" onclick="downloadResult()">ä¸‹è½½</button>
  </div>

  <textarea id="inputText" placeholder="åœ¨è¿™é‡Œç²˜è´´ä½ çš„åŸå§‹æ–‡æœ¬..."></textarea>

  <h2>æå–ç»“æœ</h2>
  <div class="result-wrap">
    <button class="btn copy-btn" onclick="copyResult('extracted')">ğŸ“‹ ä¸€é”®å¤åˆ¶</button>
    <textarea id="extracted" readonly></textarea>
  </div>

  <h2>è½¬æ¢ç»“æœ</h2>
  <div class="result-wrap">
    <button class="btn copy-btn" onclick="copyResult('converted')">ğŸ“‹ ä¸€é”®å¤åˆ¶</button>
    <textarea id="converted" readonly></textarea>
  </div>

  <p class="note">è¯´æ˜ï¼šæ”¯æŒæ‰€æœ‰å¸¸è§æ ¼å¼ï¼ˆID:.. / 21-123456 token / åç§°,ID,token ç­‰ï¼‰ï¼Œä¿æŒåŸå§‹é¡ºåºï¼Œè‡ªåŠ¨ç¼–å·ã€‚</p>

  <footer>ğŸ’ ç»ˆææ•´åˆç‰ˆ Â· åŸå§‹é¡ºåº + å¤šæ ¼å¼è¯†åˆ«</footer>
</div>

<script>
function extract() {
  const raw = document.getElementById('inputText').value || '';
  const text = raw.replace(/\r/g,'').replace(/\\n/g,'\n');

  const patterns = [
    /ID\s*:\s*(\S+)[\r\n]+Pass:\s*(\S+)/g,
    /^\s*(\d+-\d+)\s+(\S+)/gm,
    /^\s*\d+\s+(\d+-\d+)\s+(\S+)/gm,
    /^\s*\d{4},(\d+-\d+),(\S+)/gm,
    /(\d+-\d+):(\S+)/gm,
    /(\d+-\d+)=(\S+)/gm,
    /è´¦å·[:ï¼š]\s*(\d+-\d+)[\s,ï¼Œ]+(?:å¯†é’¥|token|pass)[:ï¼š]?\s*(\S+)/gi,
    /"id"\s*:\s*"(\d+-\d+)"\s*,\s*"token"\s*:\s*"(\S+?)"/gi,
    /(\d+-\d+)\+(\S+)/gm,
    /(\d+-\d+)\/(\S+)/gm,
    /^[^,\n]*?,\s*(\d+-\d+)\s*,\s*([A-Za-z0-9]+)\s*$/gm
  ];

  let results = [];
  patterns.forEach(regex=>{
    let m;
    while ((m = regex.exec(text)) !== null) {
      if (m[1] && m[2]) {
        results.push((m[1] + ' ' + m[2]).trim());
      }
    }
  });

  const lines = text.split(/\n+/).map(l => l.trim()).filter(l => l);
  lines.forEach(line=>{
    const m = line.match(/^(\d+-\d+)\s+(\S+)/);
    if (m) results.push(m[1] + ' ' + m[2]);
  });

  results = results.map(r=>r.trim()).filter(r=>r);
  results = Array.from(new Set(results));

  document.getElementById('extracted').value = results.join('\n');
  document.getElementById('converted').value = '';
}

// âœ… ä¿®æ”¹åçš„ç¼–å·é€»è¾‘
function padNumberCustom(n){
  if (n <= 99) {
    return String(n).padStart(2, '0'); // 01-99
  } else {
    return String(n).padStart(3, '0'); // 001-999
  }
}

function convert() {
  const extracted = document.getElementById('extracted').value.trim();
  if (!extracted) {
    alert('è¯·å…ˆæå–æ•°æ®ï¼');
    return;
  }

  const lines = extracted.split(/\n+/);
  const prefix = document.getElementById('prefix').value || 'ID';

  // åˆ¤æ–­æ€»è¡Œæ•°å†³å®šç¼–å·ä½æ•°
  const useThreeDigits = lines.length >= 100;

  const converted = lines.map((line, idx) => {
    const parts = line.trim().split(/\s+/);
    const id = parts[0] || '';
    const token = parts.slice(1).join(' ') || '';
    const num = useThreeDigits
      ? String(idx + 1).padStart(3, '0')  // å…¨éƒ¨ä¸‰ä½
      : String(idx + 1).padStart(2, '0'); // å…¨éƒ¨ä¸¤ä½
    return `${prefix}${num},${id},${token}`;
  }).join('\n');

  document.getElementById('converted').value = converted;
}

function clearAll() {
  document.getElementById('inputText').value = '';
  document.getElementById('extracted').value = '';
  document.getElementById('converted').value = '';
}

function copyResult(id) {
  const ta = document.getElementById(id);
  ta.select();
  document.execCommand('copy');
  alert('âœ… å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
}

function downloadResult() {
  let content = document.getElementById('converted').value.trim();
  let filename = '';
  if (content) {
    filename = (document.getElementById('prefix').value || 'ID') + '.txt';
  } else {
    content = document.getElementById('extracted').value.trim();
    filename = 'token.txt';
  }
  if (!content) {
    alert('æ²¡æœ‰å†…å®¹å¯ä»¥ä¸‹è½½ï¼');
    return;
  }
  const blob = new Blob([content], {type:'text/plain;charset=utf-8'});
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = filename;
  link.click();
}
</script>
</body>
</html>
