<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸ’ å¯†é’¥ & æå– & è½¬æ¢ â€” æœ€ç»ˆç‰ˆ</title>
<style>
  body { background:#0b0b0b; color:#ffd966; font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif; padding:20px; }
  h1 { text-align:center; margin-bottom:8px; font-size:22px; }
  .container{max-width:980px;margin:0 auto;}
  .controls{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:10px;align-items:center;}
  textarea{width:100%;height:160px;background:#111;border:1px solid #333;color:#ffd966;padding:12px;font-family:monospace;font-size:14px;resize:vertical;}
  .btn{background:#111;border:1px solid #b88a00;color:#ffd966;padding:8px 14px;border-radius:6px;cursor:pointer;}
  .btn:hover{background:#b88a00;color:#0b0b0b;box-shadow:0 6px 18px rgba(184,138,0,0.18);}
  .copy-btn{position:absolute;right:8px;top:8px;padding:6px 10px;font-size:12px}
  .result-wrap{position:relative;margin-bottom:18px;}
  label{margin-right:8px}
  .prefix-input{width:120px;padding:6px;background:#111;border:1px solid #333;color:#ffd966;border-radius:6px;}
  footer{margin-top:18px;font-size:13px;color:#bfbfbf;text-align:center;}
  .note{font-size:13px;color:#e6c86b}
</style>
</head>
<body>
<div class="container">
  <h1>ğŸ’ å¯†é’¥ & æå– & è½¬æ¢ â€” æœ€ç»ˆç‰ˆï¼ˆç®€æ´é»‘é‡‘ï¼‰</h1>

  <div class="controls">
    <a class="btn" href="https://qm.qq.com/q/3a2BdBptwA" target="_blank">ğŸ’ ä¹°æ’ä»¶è”ç³»</a>
    <label for="prefix">è½¬æ¢å‰ç¼€ï¼š</label>
    <input id="prefix" class="prefix-input" value="ID" />
    <button class="btn" onclick="extract()">æå–</button>
    <button class="btn" onclick="convert()">è½¬æ¢</button>
    <button class="btn" onclick="clearAll()">æ¸…ç©º</button>
    <button class="btn" onclick="downloadResult()">ä¸‹è½½</button>
  </div>

  <textarea id="inputText" placeholder="åœ¨è¿™é‡Œç²˜è´´ä½ çš„åŸå§‹æ–‡æœ¬..."></textarea>

  <h2>æå–ç»“æœ</h2>
  <div class="result-wrap">
    <button class="btn copy-btn" onclick="copyResult('extracted')">ğŸ“‹ ä¸€é”®å¤åˆ¶</button>
    <textarea id="extracted" readonly></textarea>
  </div>

  <h2>è½¬æ¢ç»“æœ</h2>
  <div class="result-wrap">
    <button class="btn copy-btn" onclick="copyResult('converted')">ğŸ“‹ ä¸€é”®å¤åˆ¶</button>
    <textarea id="converted" readonly></textarea>
  </div>

  <p class="note">è¯´æ˜ï¼šæ”¯æŒå¤šç§è¾“å…¥æ ¼å¼ï¼ˆID:.. Pass:.. / 15-12345678 token / åºå·,ID,token / JSON / è´¦å·ï¼šID å¯†é’¥ï¼štoken / ä»¥åŠ + / / : = ç­‰åˆ†éš”ï¼‰ï¼Œè‡ªåŠ¨å»é‡ã€è¿˜åŸ "\n" ä¸ºæ¢è¡Œå¹¶æ’åºã€‚</p>

  <footer>ç”Ÿæˆå™¨ Â· ç‰ˆæœ¬ï¼šæœ€ç»ˆç‰ˆï¼ˆåŠ¨æ€ç¼–å·ï¼š1-99 ä¸¤ä½ã€100+ ä¸‰ä½ï¼‰</footer>
</div>

<script>
function extract() {
  const raw = document.getElementById('inputText').value || '';
  // restore escaped \n, remove \r
  const text = raw.replace(/\r/g,'').replace(/\\n/g,'\n');

  const patterns = [
    /ID\s*:\s*(\S+)[\r\n]+Pass:\s*(\S+)/g,
    /^\s*(\d+-\d+)\s+(\S+)/gm,
    /^\s*\d+\s+(\d+-\d+)\s+(\S+)/gm,
    /^\s*\d{4},(\d+-\d+),(\S+)/gm,
    /(\d+-\d+):(\S+)/gm,
    /(\d+-\d+)=(\S+)/gm,
    /è´¦å·[:ï¼š]\s*(\d+-\d+)[\s,ï¼Œ]+(?:å¯†é’¥|token|pass)[:ï¼š]?\s*(\S+)/gi,
    /"id"\s*:\s*"(\d+-\d+)"\s*,\s*"token"\s*:\s*"(\S+?)"/gi,
    /(\d+-\d+)\+(\S+)/gm,
    /(\d+-\d+)\/(\S+)/gm
  ];

  let results = [];
  patterns.forEach(regex=>{
    let m;
    while ((m = regex.exec(text)) !== null) {
      // m[1] id, m[2] token (if present)
      if (m[1] && m[2]) {
        results.push((m[1] + ' ' + m[2]).trim());
      }
    }
  });

  // Also try to capture lines that already look like "id token" separated by whitespace
  const lines = text.split(/\n+/).map(l => l.trim()).filter(l => l);
  lines.forEach(line=>{
    const m = line.match(/^(\d+-\d+)\s+(\S+)/);
    if (m) results.push(m[1] + ' ' + m[2]);
  });

  // normalize: trim, dedupe, remove empty, sort
  results = results.map(r=>r.trim()).filter(r=>r);
  results = Array.from(new Set(results));
  results.sort((a,b)=>a.localeCompare(b,'zh'));

  document.getElementById('extracted').value = results.join('\n');
  document.getElementById('converted').value = '';
}

function padNumberCustom(n){
  // n is 1-based index
  if (n < 100) {
    return String(n).padStart(2,'0');
  } else {
    return String(n).padStart(3,'0');
  }
}

function convert() {
  const extracted = document.getElementById('extracted').value.trim();
  if (!extracted) {
    alert('è¯·å…ˆæå–æ•°æ®ï¼');
    return;
  }
  const lines = extracted.split(/\n+/);
  const prefix = document.getElementById('prefix').value || 'ID';
  const converted = lines.map((line, idx) => {
    const parts = line.trim().split(/\s+/);
    const id = parts[0] || '';
    const token = parts.slice(1).join(' ') || '';
    const n = idx + 1;
    const num = padNumberCustom(n);
    return `${prefix}${num},${id},${token}`;
  }).join('\n');
  document.getElementById('converted').value = converted;
}

function clearAll() {
  document.getElementById('inputText').value = '';
  document.getElementById('extracted').value = '';
  document.getElementById('converted').value = '';
}

function copyResult(id) {
  const ta = document.getElementById(id);
  ta.select();
  document.execCommand('copy');
  alert('âœ… å·²å¤åˆ¶åˆ°å‰ªè´´æ¿');
}

function downloadResult() {
  let content = document.getElementById('converted').value.trim();
  let filename = '';
  if (content) {
    filename = (document.getElementById('prefix').value || 'ID') + '.txt';
  } else {
    content = document.getElementById('extracted').value.trim();
    filename = 'token.txt';
  }
  if (!content) {
    alert('æ²¡æœ‰å†…å®¹å¯ä»¥ä¸‹è½½ï¼');
    return;
  }
  const blob = new Blob([content], {type:'text/plain;charset=utf-8'});
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = filename;
  link.click();
}
</script>
</body>
</html>
