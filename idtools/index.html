<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ’ å¯†é’¥ & æå– & è½¬æ¢</title>
<style>
    body {
        background-color: #111;
        color: #ffd700;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        padding: 20px;
    }
    h1 {
        text-align: center;
        font-size: 2em;
        margin-bottom: 20px;
    }
    textarea {
        width: 100%;
        height: 150px;
        background-color: #222;
        color: #ffd700;
        border: 2px solid #444;
        padding: 10px;
        resize: vertical;
        font-family: monospace;
        font-size: 14px;
    }
    .result-container {
        position: relative;
        margin-top: 10px;
    }
    .btn {
        background-color: #222;
        color: #ffd700;
        border: 2px solid #ffd700;
        padding: 8px 16px;
        margin: 5px 5px 5px 0;
        cursor: pointer;
        font-size: 14px;
        transition: 0.2s;
    }
    .btn:hover {
        background-color: #ffd700;
        color: #111;
    }
    .copy-btn {
        position: absolute;
        top: 5px;
        right: 5px;
        font-size: 12px;
        padding: 5px 10px;
    }
    .prefix-input {
        width: 150px;
        margin-left: 10px;
        padding: 5px;
        background-color: #222;
        color: #ffd700;
        border: 2px solid #444;
    }
</style>
</head>
<body>
<h1>ğŸ’ å¯†é’¥ & æå– & è½¬æ¢</h1>

<label for="prefix">å‰ç¼€ï¼š</label>
<input type="text" id="prefix" class="prefix-input" value="ID">

<textarea id="inputText" placeholder="åœ¨è¿™é‡Œç²˜è´´ä½ çš„æ–‡æœ¬..."></textarea>

<div style="margin-top:10px;">
    <button class="btn" onclick="extract()">æå–</button>
    <button class="btn" onclick="convert()">è½¬æ¢</button>
    <button class="btn" onclick="clearAll()">æ¸…ç©º</button>
    <button class="btn" onclick="downloadResult()">ä¸‹è½½</button>
</div>

<h2>æå–ç»“æœ</h2>
<div class="result-container">
    <button class="btn copy-btn" onclick="copyResult('extracted')">ğŸ“‹ ä¸€é”®å¤åˆ¶</button>
    <textarea id="extracted" readonly></textarea>
</div>

<h2>è½¬æ¢ç»“æœ</h2>
<div class="result-container">
    <button class="btn copy-btn" onclick="copyResult('converted')">ğŸ“‹ ä¸€é”®å¤åˆ¶</button>
    <textarea id="converted" readonly></textarea>
</div>

<script>
function extract() {
    const text = document.getElementById('inputText').value;
    const idRegex1 = /ID\s*:\s*(\S+)[\r\n]+Pass:\s*(\S+)/g;
    const idRegex2 = /^\s*(\d+[-]\d+)\s+(\S+)/gm;
    const idRegex3 = /^\s*\d+\s+(\d+[-]\d+)\s+(\S+)/gm;
    let match;
    let results = [];

    [idRegex1, idRegex2, idRegex3].forEach(regex => {
        while ((match = regex.exec(text)) !== null) {
            results.push(`${match[1]} ${match[2]}`);
        }
    });

    document.getElementById('extracted').value = results.join('\n');
    document.getElementById('converted').value = ''; // æ¸…ç©ºè½¬æ¢ç»“æœ
}

function convert() {
    const extracted = document.getElementById('extracted').value.trim();
    if (!extracted) {
        alert('è¯·å…ˆæå–æ•°æ®ï¼');
        return;
    }
    const lines = extracted.split('\n');
    const prefix = document.getElementById('prefix').value || 'ID';
    const converted = lines.map((line, idx) => {
        const [id, token] = line.split(' ');
        let num = idx + 1;
        let numStr = num < 100 ? String(num).padStart(2,'0') : String(num).padStart(3,'0');
        return `${prefix}${numStr},${id},${token}`;
    }).join('\n');
    document.getElementById('converted').value = converted;
}

function clearAll() {
    document.getElementById('inputText').value = '';
    document.getElementById('extracted').value = '';
    document.getElementById('converted').value = '';
}

function copyResult(id) {
    const textarea = document.getElementById(id);
    textarea.select();
    document.execCommand('copy');
    alert('âœ… å·²å¤åˆ¶ï¼');
}

function downloadResult() {
    let content = document.getElementById('converted').value.trim();
    let filename = '';
    if (content) {
        filename = (document.getElementById('prefix').value || 'ID') + '.txt';
    } else {
        content = document.getElementById('extracted').value.trim();
        filename = 'token.txt';
    }
    if (!content) {
        alert('æ²¡æœ‰å†…å®¹å¯ä»¥ä¸‹è½½ï¼');
        return;
    }
    const blob = new Blob([content], {type: 'text/plain;charset=utf-8'});
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = filename;
    link.click();
}
</script>
</body>
</html>
