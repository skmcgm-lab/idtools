<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>密钥 & 提取 & 转换</title>
<style>
    body {
        font-family: 'Segoe UI', sans-serif;
        background-color: #0e0e0e;
        color: #f1c40f;
        margin: 0;
        padding: 20px;
        text-align: center;
    }
    h1 {
        color: #f39c12;
        margin-bottom: 20px;
    }
    textarea {
        width: 90%%;
        height: 220px;
        margin: 10px 0;
        padding: 10px;
        border: 2px solid #f1c40f;
        border-radius: 10px;
        background-color: #1c1c1c;
        color: #f1c40f;
        font-size: 14px;
    }
    input {
        padding: 10px;
        border-radius: 8px;
        border: 1px solid #f1c40f;
        background-color: #1c1c1c;
        color: #f1c40f;
        margin: 5px;
    }
    button {
        padding: 10px 20px;
        background-color: #f39c12;
        border: none;
        border-radius: 8px;
        color: #fff;
        font-size: 16px;
        cursor: pointer;
        transition: background 0.3s;
        margin: 5px;
    }
    button:hover {
        background-color: #d68910;
    }
    #output {
        white-space: pre-wrap;
        text-align: left;
        width: 90%%;
        margin: 20px auto;
        border: 1px solid #f1c40f;
        border-radius: 10px;
        padding: 10px;
        background-color: #1c1c1c;
    }
</style>
</head>
<body>
<h1>密钥 & 提取 & 转换</h1>
<textarea id="inputText" placeholder="在此粘贴需要提取的内容"></textarea><br>
<input type="text" id="namePrefix" placeholder="输入前缀名，如：名字"><br>
<button onclick="extract()">开始提取与转换</button>
<button onclick="copyOutput()">复制结果</button>
<button onclick="downloadFile()">一键下载</button>
<pre id="output"></pre>

<script>
function extract() {
    const text = document.getElementById('inputText').value.trim();
    const prefix = document.getElementById('namePrefix').value.trim() || "名字";
    const lines = text.split(/\n+/);
    let results = [];
    let idRegex1 = /ID\s*[:：]\s*(\S+)/i;
    let passRegex1 = /Pass\s*[:：]\s*(\S+)/i;
    let idRegex2 = /^\d+\s+([0-9]+-[0-9]+)\s+(\S+)/;
    let idRegex3 = /^([0-9]+-[0-9]+)\s+(\S+)/;

    let count = 1;

    for (let line of lines) {
        line = line.trim();
        if (!line) continue;

        let id = "", token = "";

        if (line.match(idRegex1)) {
            id = line.match(idRegex1)?.[1] || "";
            token = text.match(passRegex1)?.[1] || "";
        } else if (line.match(idRegex2)) {
            let m = line.match(idRegex2);
            id = m[1];
            token = m[2];
        } else if (line.match(idRegex3)) {
            let m = line.match(idRegex3);
            id = m[1];
            token = m[2];
        }

        if (id && token) {
            let num = count < 10 ? "0" + count : (count < 100 ? count : ("0" + count).slice(-3));
            results.push(`${prefix}${num},${id},${token}`);
            count++;
        }
    }

    document.getElementById('output').textContent = results.join("\n") || "未识别到有效内容";
}

function copyOutput() {
    const text = document.getElementById('output').textContent;
    navigator.clipboard.writeText(text);
    alert("结果已复制！");
}

function downloadFile() {
    const content = document.getElementById('output').textContent;
    const blob = new Blob([content], { type: 'text/plain' });
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = '转换结果.txt';
    link.click();
}
</script>
</body>
</html>